(function(){var t=function(t,i){return function(){return t.apply(i,arguments)}};this.FilmRoll=function(){function i(i){this.options=null!=i?i:{},this.cloneRight=t(this.cloneRight,this),this.cloneLeft=t(this.cloneLeft,this),this.resize=t(this.resize,this),this.moveRight=t(this.moveRight,this),this.moveLeft=t(this.moveLeft,this),this.clearScroll=t(this.clearScroll,this),this.configureScroll=t(this.configureScroll,this),this.configureWidths=t(this.configureWidths,this),this.configureLoad=t(this.configureLoad,this),this.configureHover=t(this.configureHover,this),this.options.container&&(this.div=jQuery(this.options.container),this.div.length&&this.configure())}return i.prototype.configure=function(){var t;return this.children=this.div.children(),this.children.wrapAll('<div class="film_roll_wrapper"></div>'),this.children.wrapAll('<div class="film_roll_shuttle"></div>'),this.wrapper=this.div.find(".film_roll_wrapper"),this.shuttle=this.div.find(".film_roll_shuttle"),this.rotation=[],this.ldupes=[],this.rdupes=[],this.shuttle.width(this.options.shuttle_width?parseInt(this.options.shuttle_width,10):1e4),this.options.start_height&&this.wrapper.height(parseInt(this.options.start_height,10)),this.options.vertical_center&&this.shuttle.addClass("vertical_center"),this.options.no_css===!0||document.film_roll_styles_added||(jQuery("<style type='text/css'> .film_roll_wrapper{display:block;text-align:center;float:none;position:relative;top:auto;right:auto;bottom:auto;left:auto;z-index:auto;width:100%;height:100%;margin:0 !important;padding:0 !important;overflow:hidden;} .film_roll_shuttle{text-align:left;float:none;position:relative;top:0;left:0;right:auto;bottom:auto;height:100%;margin:0 !important;padding:0 !important;z-index:auto;} .film_roll_shuttle.vertical_center:before{content:'';display:inline-block;height:100%;vertical-align:middle;margin-right:-0.25em;} .film_roll_child{position:relative;display:inline-block;*display:inline;vertical-align:middle;zoom:1;} .film_roll_prev,.film_roll_next{position:absolute;top:48%;left:15px;width:40px;height:40px;margin:-20px 0 0 0;padding:0;font-size:60px;font-weight:100;line-height:30px;color:white;text-align:center;background:#222;border:3px solid white;border-radius:23px;opacity:0.5} .film_roll_prev:hover,.film_roll_next:hover{color:white;text-decoration:none;opacity:0.9} .film_roll_next{left:auto;right:15px} .film_roll_pager{text-align:center;} .film_roll_pager a{width:5px;height:5px;border:2px solid #333;border-radius:5px;display:inline-block;margin:0 5px 0 0;transition:all 1s ease} .film_roll_pager a:hover{background:#666} .film_roll_pager a.active{background:#333} .film_roll_pager span{display:none} .film_roll_pager a,a.film_roll_prev,a.film_roll_next{-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;} </style>").appendTo("head"),document.film_roll_styles_added=!0),this.options.pager!==!1&&(this.pager=jQuery('<div class="film_roll_pager">'),this.div.append(this.pager),this.children.each(function(t){return function(i,e){var r;return r=jQuery("<a href='#' data-id='"+e.id+"'><span>"+(i+1)+"</span></a>"),t.pager.append(r),r.click(function(){return t.index=i,t.moveToIndex(t.index,"best",!0),!1})}}(this))),this.pager_links=this.div.find(".film_roll_pager a"),"scroll"===this.options.hover?(this.options.scroll=!1,this.hover_in=function(t){return function(){return clearTimeout(t.hover_timer),t.hover_timer=setTimeout(function(){return t.moveLeft(),t.configureScroll()},300)}}(this),this.hover_out=this.clearScroll):this.options.hover!==!1&&(this.hover_in=function(t){return function(){return clearTimeout(t.hover_timer),t.hover_timer=setTimeout(function(){return t.clearScroll()},300)}}(this),this.hover_out=this.configureScroll),this.options.hover!==!1&&(this.mouse_catcher=jQuery('<div style="position:absolute; top:0; left: 0; height: 100%; width: 100%;" class="film_roll_mouse_catcher"></div>'),this.mouse_catcher.appendTo(this.wrapper).mousemove(function(t){return function(){return t.hover_in(),t.mouse_catcher.remove()}}(this))),t=null,this.children.each(function(t){return function(i,e){var r;return r=jQuery(e),r.attr("data-film-roll-child-id",i),r.addClass("film_roll_child"),t.rotation.push(e)}}(this)),this.options.prev&&this.options.next?(this.prev=jQuery(this.options.prev),this.next=jQuery(this.options.next)):(this.wrapper.append('<a class="film_roll_prev" href="#">&lsaquo;</a>'),this.wrapper.append('<a class="film_roll_next" href="#">&rsaquo;</a>'),this.prev=this.div.find(".film_roll_prev"),this.next=this.div.find(".film_roll_next")),this.prev.click(function(t){return function(){return t.moveRight()}}(this)),this.next.click(function(t){return function(){return t.moveLeft()}}(this)),this.index=this.options.start_index||0,this.interval=this.options.interval||4e3,this.animation=this.options.animation||this.interval/4,this.easing=this.options.easing===!1?!1:this.options.easing||"swing","css"===this.options.easing&&(jQuery("<style type='text/css'>"+this.options.container+" .film_roll_shuttle.transition {transition: left "+this.animation+"ms;}</style>").appendTo("head"),this.shuttle.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(t){return function(){return console.log("transitioned"),t.shuttle.removeClass("transition"),t.div.trigger(jQuery.Event("film_roll:moved")),t.moveToClear(t.direction)}}(this))),this.options.resize!==!1&&jQuery(window).resize(function(t){return function(){return t.resize()}}(this)),this.options.configure_load?"function"==typeof this.options.configure_load?this.options.configure_load.apply(this,arguments):this.configureLoad():jQuery(window).load(this.configureLoad),this.div.trigger(jQuery.Event("film_roll:dom_ready")),this},i.prototype.bestDirection=function(t,i){return null==i&&(i=jQuery.inArray(t,this.rotation)),i<this.children.length/2?"right":"left"},i.prototype.configureHover=function(){return this.div.hover(this.hover_in,this.hover_out),this.options.prev&&this.options.next?(this.prev.hover(this.hover_in,this.hover_out),this.next.hover(this.hover_in,this.hover_out)):void 0},i.prototype.configureLoad=function(){return this.configureWidths(),this.moveToIndex(this.index,"right",!0),"scroll"===this.options.hover?(this.options.scroll=!1,this.configureHover()):this.options.scroll!==!1&&(this.configureScroll(),this.options.hover!==!1)?this.configureHover():void 0},i.prototype.configureWidths=function(){var t;return this.width=t=0,this.wrapper.css({height:"","min-height":0}),this.shuttle.width("").removeClass("film_roll_shuttle").addClass("film_roll_resizing"),this.children.width(""),this.div.trigger(jQuery.Event("film_roll:resizing")),this.child_widths=[],this.children.each(function(i){return function(e,r){var o,s,n;return o=jQuery(r),n=o.outerWidth(!0),o.width(n),i.child_widths.push(n),i.width+=n,i.options.height||(s=o.outerHeight(!0),s>t&&(t=s)),r}}(this)),this.options.height?this.wrapper.height(this.options.height):(this.wrapper.height(""),this.wrapper.css("min-height",t)),this.real_width=this.width,this.shuttle.width(2*this.real_width).removeClass("film_roll_resizing").addClass("film_roll_shuttle"),this},i.prototype.configureScroll=function(){return this.scrolled!==!0&&(this.timer=setInterval(function(t){return function(){return t.moveLeft()}}(this),this.interval),this.scrolled=!0),this},i.prototype.clearScroll=function(){return this.scrolled!==!1&&(clearInterval(this.timer),this.scrolled=!1),this},i.prototype.childIndex=function(t){var i;return t=jQuery(t)[0],t?(i=t.getAttribute("data-film-roll-child-id"),i||jQuery.inArray(t,this.children)):void 0},i.prototype.childWidth=function(t){var i;return i=this.childIndex(t),this.child_widths[i]||jQuery(t).outerWidth(!0)},i.prototype.rotationIndex=function(t){return jQuery.inArray(t,this.rotation)},i.prototype.marginLeft=function(t,i){var e,r,o;for(null==i&&(i=0),o=0,r=t;r>i;)o+=this.childWidth(this.rotation[i++]);return e=this.rotation[t].getAttribute("data-film-roll-child-id"),jQuery.each(this.rdupes,function(t){return function(i,r){return r.data("filmRollChildId")!==e?o+=t.childWidth(r):void 0}}(this)),o},i.prototype.marginRight=function(t,i){var e,r,o;for(null==i&&(i=0),i=this.rotation.length-i-1,o=0,r=t+1;i>r;)o+=this.childWidth(this.rotation[r++]);return e=this.rotation[t].getAttribute("data-film-roll-child-id"),jQuery.each(this.ldupes,function(t){return function(i,r){return r.data("filmRollChildId")!==e?o+=t.childWidth(r):void 0}}(this)),o},i.prototype.moveLeft=function(){return this.index=(this.index+1)%this.children.length,this.moveToIndex(this.index,"left",!0),!1},i.prototype.moveRight=function(){var t;return t=this.children.length,this.index=(this.index+t-1)%t,this.moveToIndex(this.index,"right",!0),!1},i.prototype.moveToChild=function(t){var i;return i=this.childIndex(t),i>-1?this.moveToIndex(i):void 0},i.prototype.moveToIndex=function(t,i){var e,r,o,s,n,h,l,a,u,d;if(this.index=t,l=this.scrolled,this.clearScroll(),e=this.children[t],h=jQuery.inArray(e,this.rotation),i&&"best"!==i||(i=this.bestDirection(e,h)),this.children.removeClass("active"),jQuery(e).addClass("active").trigger(jQuery.Event("film_roll:activate")),this.pager_links.removeClass("active"),jQuery(this.pager_links[t]).addClass("active"),d=this.wrapper.width(),d<this.real_width){if(u=(d-this.child_widths[t])/2,a=this.shuttleLeft(),"right"===i)for(o=this.marginLeft(h);u>o;)o+=this.cloneRight(a),this.rotation.unshift(this.rotation.pop());else{for(s=this.marginRight(h);u>s;)s+=this.cloneLeft(),this.rotation.push(this.rotation.shift());o=this.marginLeft(h)}this.shuttle_left=n=-1*(o-u),"css"===this.easing?(this.shuttle.addClass("transition"),this.direction=i,this.shuttle.css("left",n)):this.easing===!1?(this.shuttle.css("left",n),this.div.trigger(jQuery.Event("film_roll:moved")),this.moveToClear(i)):(r="moving_"+i,this.shuttle.addClass(r),this.div.trigger(jQuery.Event("film_roll:moving")),this.shuttle.stop().animate({left:n},this.animation,this.easing,function(t){return function(){return t.shuttle.removeClass(r),t.moveToClear(i),t.div.trigger(jQuery.Event("film_roll:moved"))}}(this)))}else this.shuttle.css("left",(d-this.width)/2);return l&&this.configureScroll(),this},i.prototype.moveToClear=function(t){var i,e,r;for(r=this.shuttle_left;i=this.ldupes.shift();)e=this.childIndex(i),this.shuttle.append(jQuery(this.children[e]).detach()),r+=this.child_widths[e],i.remove();for(;i=this.rdupes.shift();)e=this.childIndex(i),this.shuttle.prepend(jQuery(this.children[e]).detach()),i.remove();return this.shuttle.css("left",r),delete this.shuttle_left,r},i.prototype.resize=function(){return clearTimeout(this.resize_timer),this.resize_timer=setTimeout(function(t){return function(){var i;return i=t.scrolled,t.clearScroll(),i&&t.configureScroll(),t.configureWidths(),t.moveToIndex(t.index,"best"),t.div.trigger(jQuery.Event("film_roll:resized"))}}(this),200),this},i.prototype.cloneLeft=function(t){var i,e,r,o,s,n;for(null==t&&(t=1),r=-1,i=0,n=this.ldupes.length,s=this.rotation.length;(r+=1)<t;)o=(r+n)%s,e=jQuery(this.rotation[o]).clone(),i+=this.childWidth(e),this.shuttle.append(e),this.ldupes.push(e);return i},i.prototype.cloneRight=function(t,i){var e,r,o,s,n,h;for(null==i&&(i=1),e=0,h=this.rdupes.length,n=this.rotation.length,o=-1;(o+=1)<i;)s=(o+n-1-h)%n,r=jQuery(this.rotation[s]).clone(),e+=this.childWidth(r),this.shuttle.prepend(r),this.rdupes.push(r);return this.shuttle.css("left",t-e),e},i.prototype.shuttleLeft=function(){var t;return t=this.shuttle.css("left"),t?parseInt(t,10):0},i}()}).call(this);