// Generated by CoffeeScript 1.6.1
/*
  FilmRoll (for jQuery)
  version: 0.1.0 (08/21/2013)
  @requires jQuery >= v1.4

  By Noel Peden
  Examples at http://film_roll.github.io

  Licensed under the MIT:
    http://www.opensource.org/licenses/mit-license.php

  Usage:
    var film_troll = new FilmRoll({container: '#container_id', OPTIONS});
*/(function(){var e=this;this.FilmRoll=function(){function e(t){var n=this;this.options=t!=null?t:{};this.rotateRight=function(){return e.prototype.rotateRight.apply(n,arguments)};this.rotateLeft=function(){return e.prototype.rotateLeft.apply(n,arguments)};this.moveRight=function(){return e.prototype.moveRight.apply(n,arguments)};this.moveLeft=function(){return e.prototype.moveLeft.apply(n,arguments)};this.expand=function(){return e.prototype.expand.apply(n,arguments)};this.clearScroll=function(){return e.prototype.clearScroll.apply(n,arguments)};this.configureScroll=function(){return e.prototype.configureScroll.apply(n,arguments)};this.configureWidths=function(){return e.prototype.configureWidths.apply(n,arguments)};if(this.options.container){this.div=jQuery(this.options.container);this.div.length&&this.configure()}}e.prototype.configure=function(){var e,t,n=this;if(this.options.no_css!==!0&&!document.film_roll_styles_added){jQuery("<style type='text/css'>        .film_roll_wrapper {display: block; text-align: center; float: none; position: relative; top: auto; right: auto; bottom: auto; left: auto; z-index: auto; width: 100%; margin: 0px; overflow: hidden; width: 100%}        .film_roll_shuttle {text-align: left; float: none; position: absolute; top: 0; left:0; right: auto; bottom: auto; margin: 0px; z-index: auto}        .film_roll_prev, .film_roll_next {position:absolute; top:48%; left:15px; width:40px; height:40px; margin:-20px 0 0 0; padding:0; font-size:60px; font-weight:100; line-height:30px; color:white; text-align: center; background: #222; border: 3px solid white; border-radius:23px; opacity:0.5}        .film_roll_prev:hover, .film_roll_next:hover {color:white; text-decoration:none; opacity:0.9}        .film_roll_next {left:auto; right:15px}        .film_roll_pager {text-align:center}        .film_roll_pager a {width:5px; height:5px; border:2px solid #333; border-radius:5px; display:inline-block; margin:0 5px 0 0; transition: all 1s ease}        .film_roll_pager a:hover {background: #666}        .film_roll_pager a.active {background: #333}        .film_roll_pager span {display:none}      </style>").appendTo("head");document.film_roll_styles_added=!0}this.children=this.div.children();this.children.wrapAll('<div class="film_roll_wrapper"></div>');this.children.wrapAll('<div class="film_roll_shuttle"></div>');this.wrapper=this.div.find(".film_roll_wrapper");this.shuttle=this.div.find(".film_roll_shuttle");this.rotation=[];if(this.options.pager!==!1){this.pager=jQuery('<div class="film_roll_pager">');this.div.append(this.pager);this.children.each(function(e,t){var r;r=jQuery("<a href='#' data-id='"+t.id+"'><span>"+(e+1)+"</span></a>");n.pager.append(r);return r.click(function(){var t,r;n.index=e;r=jQuery.inArray(n.children[e],n.rotation);t=r<n.children.length/2?"right":"left";return n.moveToIndex(n.index,t,!0)})})}this.pager_links=this.div.find(".film_roll_pager a");e=null;this.children.each(function(e,t){var r;r=jQuery(t);r.attr("style","position:relative; display:inline-block; vertical-align:middle");r.attr("data-film-roll-child-id",e);r.addClass("film_roll_child");return n.rotation.push(t)});t=this.options.shuttle_width?parseInt(this.options.shuttle_width,10):1e4;this.shuttle.width(t);this.height=this.options.height?parseInt(this.options.height,10):0;this.wrapper.height(this.height);this.shuttle.height(this.height);if(this.options.prev&&this.options.next){this.prev=jQuery(this.options.prev);this.next=jQuery(this.options.next)}else{this.wrapper.append('<a class="film_roll_prev" href="#">&lsaquo;</a>');this.wrapper.append('<a class="film_roll_next" href="#">&rsaquo;</a>');this.prev=this.div.find(".film_roll_prev");this.next=this.div.find(".film_roll_next")}this.prev.click(this.moveRight);this.next.click(this.moveLeft);this.index=this.options.start_index||0;this.options.expand===!0&&this.expand();this.interval=this.options.interval||4e3;this.animation=this.options.animation||this.interval/4;if(this.options.scroll!==!1){this.div.hover(this.clearScroll,this.configureScroll);if(this.options.prev&&this.options.next){this.prev.hover(this.clearScroll,this.configureScroll);this.next.hover(this.clearScroll,this.configureScroll)}}jQuery(window).resize(function(){return n.resize()});jQuery(window).load(function(){n.configureWidths();n.moveToIndex(n.index,"right",!1);if(n.options.scroll!==!1)return n.configureScroll()});return this};e.prototype.configureWidths=function(){var e,t,n=this;this.width=e=0;this.children.each(function(t,r){var i,s;i=jQuery(r);n.width+=i.width();s=i.outerHeight(!0);if(s>e)return e=s});this.options.height||(this.height=e);this.wrapper.height(this.height);this.shuttle.height(this.height);this.real_width=this.width;t=this.wrapper.width();t<this.real_width&&t*2>this.real_width&&this.options.expand==null&&this.expand();this.options.expand===!0&&(this.real_width*=3);this.shuttle.width(this.real_width*2);return this};e.prototype.configureScroll=function(){var e=this;this.timer=setInterval(function(){return e.moveLeft()},this.interval);return this};e.prototype.clearScroll=function(){clearInterval(this.timer);return this};e.prototype.expand=function(){var e,t=this;this.options.expand=!0;e=null;return this.children.each(function(n,r){var i,s,o,u;i=jQuery(r);e||(e=i);o=i.clone();u=i.clone();s=i.attr("id");if(s){o.attr("id",s+"_post");u.attr("id",s+"_pre")}t.shuttle.append(o);return e.before(u)})};e.prototype.marginLeft=function(e,t){var n,r,i,s,o,u;t==null&&(t=0);i=0;u=this.rotation;for(r=s=0,o=u.length;s<o;r=++s){n=u[r];r<e&&r>=t&&(i+=jQuery(n).width())}return i};e.prototype.marginRight=function(e,t){var n,r,i,s,o,u;t==null&&(t=0);t=this.rotation.length-t-1;i=0;u=this.rotation;for(r=s=0,o=u.length;s<o;r=++s){n=u[r];r>e&&r<=t&&(i+=jQuery(n).width())}return i};e.prototype.moveLeft=function(){this.index=(this.index+1)%this.children.length;this.moveToIndex(this.index,"left",!0);return!1};e.prototype.moveRight=function(){this.index-=1;this.index<0&&(this.index=this.children.length-1);this.moveToIndex(this.index,"right",!0);return!1};e.prototype.moveToIndex=function(e,t,n){var r,i,s,o,u,a;n==null&&(n=!0);r=this.children[e];o=jQuery.inArray(r,this.rotation);if(this.options.expand){i=this.shuttle.children();i.removeClass("active");jQuery(i[o+this.children.length]).addClass("active")}else{this.children.removeClass("active");jQuery(r).addClass("active")}this.pager_links.removeClass("active");jQuery(this.pager_links[e]).addClass("active");a=this.wrapper.width();if(a<this.real_width){u=(a-jQuery(r).width())/2;if(t==="right")while(o===0||this.marginLeft(o)<u){this.rotateRight();o=jQuery.inArray(r,this.rotation)}else while(o===this.children.length-1||this.marginRight(o)<u){this.rotateLeft();o=jQuery.inArray(r,this.rotation)}s=-1*(this.marginLeft(o)-u);this.options.expand&&(s-=this.width);n?this.shuttle.animate({left:s},this.animation,"swing"):this.shuttle.css("left",s)}else this.shuttle.css("left",(a-this.width)/2);return this};e.prototype.resize=function(){var e=this;clearTimeout(this.resize_timer);this.resize_timer=setTimeout(function(){return e.moveToIndex(e.index,"left")},200);return this};e.prototype.rotateLeft=function(){var e,t,n;e=this.shuttle.css("left");n=e?parseInt(e,10):0;t=this.rotation.shift();this.rotation.push(t);this.shuttle.css("left",n+jQuery(t).width());return this.shuttle.append(this.shuttle.children().first().detach())};e.prototype.rotateRight=function(){var e,t,n;e=this.shuttle.css("left");n=e?parseInt(e,10):0;t=this.rotation.pop();this.rotation.unshift(t);this.shuttle.css("left",n-jQuery(t).width());return this.shuttle.prepend(this.shuttle.children().last().detach())};return e}()}).call(this);